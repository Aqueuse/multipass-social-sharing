{% extends "base.html" %}

{% block stylesheet %}
    <link rel="stylesheet" href="{{ baseURL }}/static/css/tasks.css" xmlns="http://www.w3.org/1999/html">
{% endblock %}

{% block navigation %}
    <div class="navigation">
        <button><a style="text-decoration: none;" href="/{{ username }}/account">Account</a></button>
        <button><a style="text-decoration: none;" href="/logout">Logout</a></button>
    </div>
{% endblock %}

{% block content %}
<script src="{{ baseURL }}/static/js/tasks.js"></script>
<div class=resume-container>
    {% for key, value in dict_tasks_summary.items() %}
    <div class="resume {{ key }}-resume">
        <h3 class="resume-title">{{ key|capitalize }}</h3>
        {% if value|length == 0 %}
            <button class="schedule-button"><a href="{{ baseurl }}{{ key }}/create"><strong>+</strong> Schedule</a></button>
            <p class=task-empty>You don't have any post in {{ key|capitalize }}</p>
        {% endif %}
        {% if value|length > 0 %}
            {% for subelement in value %}
                <div>
                    {{ subelement.taskname }} | {{ subelement.repetition.type }}
                    <button id="{{ key }}-{{ subelement.id }}-task-button" class="show-task-fields" onclick="taskSwitch('{{ key }}', '{{ subelement.id }}')">‚óÅ</button>
                </div>
                <div id="{{ key }}-{{ subelement.id }}-task-block" class="task-block" style="display: none">
                <form  enctype="multipart/form-data" method="post">
                    <input type="hidden" name="id" value="{{ subelement.id }}">
                    <input type=text class="task-field" name="taskname" value="{{ subelement.taskname }}">
                    <div class="task-container">

                        <input type=datetime-local name=date value="{{ subelement.date }}">
                    </div>
                    <label>Repetition :
                        <select id="{{ key }}-{{ subelement.id }}-repetition" name="repetition_frequency" onchange="showPeriods('{{ key }}', '{{ subelement.id }}')">
                            <option value="{{ subelement.repetition.frequency }}" selected>current : {{ subelement.repetition.frequency }}</option>
                            <option value="daily">daily</option>
                            <option value="weekly">weekly</option>
                            <option value="monthly">monthly</option>
                            <option value="custom">custom</option>
                        </select>
                    </label>
                    <div class="period-selecter">
                        <div style="display:none;" id="{{ key }}-{{ subelement.id }}-months">
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-JAN" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'JAN')">JAN</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-FEB" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'FEB')">FEB</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-MAR" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'MAR')">MAR</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-APR" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'APR')">APR</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-MAY" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'MAY')">MAY</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-JUN" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'JUN')">JUN</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-JUL" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'JUL')">JUL</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-AUG" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'AUG')">AUG</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-SEP" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'SEP')">SEP</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-OCT" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'OCT')">OCT</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-NOV" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'NOV')">NOV</span>
                            <span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-DEC" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'months', 'DEC')">DEC</span>
                            <input id="{{ key }}-{{ subelement.id }}-task-months" type=hidden name="months" value="{{ subelement.repetition.months }}">
                        </div>
                    </div>
                    <div class="period-selecter">
                        <div style="display:none;" id="{{ key }}-{{ subelement.id }}-days">
                            <label><span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-MO" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'days', 'MO')">MO</span></label>
                            <label><span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-TU" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'days', 'TU')">TU</span></label>
                            <label><span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-WE" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'days', 'WE')">WE</span></label>
                            <label><span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-TH" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'days', 'TH')">TH</span></label>
                            <label><span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-FR" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'days', 'FR')">FR</span></label>
                            <label><span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-SA" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'days', 'SA')">SA</span></label>
                            <label><span style="background-color: lightsteelblue" id="{{ key }}-{{ subelement.id }}-span-SU" class="round-span" onclick="switchElement('{{ key }}', '{{ subelement.id }}', 'days', 'SU')">SU</span></label>
                            <input id="{{ key }}-{{ subelement.id }}-task-days" type=hidden name="days" value="{{ subelement.repetition.days }}">
                        </div>
                    </div>
                    <textarea name=message class="task-field">{{ subelement.message }}</textarea><br>
                    <input
                            id="{{ key }}-{{ subelement.id }}-images-input"
                            class="task-field"
                            type=file multiple="" name="files[]"
                            onchange="updateImagesList('{{ key }}', '{{ subelement.id }}')"
                    ><br>
                    <button type="button" id="remove-images-button" onclick="removeImagesFromList('{{ key }}', '{{ subelement.id }}')">remove images</button>
                    <div id="{{ key }}-{{ subelement.id }}-images-list">
                        {% for element in subelement.imagesList %}
                            <div class="task-image">{{ element }}</div>
                        {% endfor %}
                    </div>
                    <div class="task-container">
                        <input type=submit formaction="/{{ key }}/delete" value="delete">
                        <input class="task-duplicate" type=submit formaction="/{{ key }}/duplicate" value="duplicate">
                        <input class="task-submit" type=submit formaction="/{{ key }}/edit" value="update">
                    </div>
                </form>
                </div>
            {% endfor %}
        {% endif %}
        </div>
    {% endfor %}
</div>
{% endblock %}
